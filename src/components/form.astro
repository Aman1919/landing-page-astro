---
const { classes } = Astro.props;
---

<div class={`h-full text-black w-full md:w-auto max-w-md p-6 rounded-lg ${classes}`}>
  <h1 class="text-2xl md:text-3xl font-bold mb-4">Enquiry form</h1>
  <form class="space-y-4" name="contact-form" id="contact-form" >
    <input
      type="text"
      placeholder="Your Name"
      name="Name"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      required
    />
    <input
      type="email"
      placeholder="Your Email"
      name="Email"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      required
    />
    <input
      type="text"
      placeholder="Your Phone"
      name="Phone no."
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      required
    />
    <input
      type="text"
      placeholder="Your Subject"
      name="Subject"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <textarea
      placeholder="Your Message"
      name="Description"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
    ></textarea>
    <button type="submit" class="w-full p-3 rounded">
      Send Message
    </button>
  </form>
</div>

<script>

  const form = document.forms['contact-form'];

form.addEventListener('submit', handleSubmit);

async function handleSubmit(e) {
  e.preventDefault();
  
  const name = form["Name"].value;
  const email = form["Email"].value;
  const phone = form["Phone no."].value;
  
  const url = "https://script.google.com/macros/s/AKfycbxjrm0JHKX8opCyekMFHUFVGB-FpSR6GsimoNLvZNbs_5YSh_SCZoEOtD5SnDjXgHEw/exec";

  // Validate inputs
  if (!name || !email || !phone || phone.length < 10) {
    alert("Please fill all fields and ensure phone number is at least 10 digits.");
    return;
  }

  // Create FormData object after validation
  const formData = new FormData(form);

  try {
    const response = await fetch(url, {
      method: 'POST',
      body: formData, // Sending form data
    });

    if (response.ok) {
      alert("Thank you! Your form is submitted successfully.");
      form.reset(); // Reset form after successful submission
      window.location.reload(); // Reload the page if needed
    } else {
      alert("Failed to submit the form. Please try again.");
    }
  } catch (e) {
    console.log('Error:', e);
    alert("An error occurred. Please try again.");
  }
}

</script>

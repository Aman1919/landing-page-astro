---
const { classes } = Astro.props;
---

<div class={`h-full text-black w-full md:w-auto max-w-md p-6 rounded-lg ${classes}`}>
  <h1 class="text-2xl md:text-3xl font-bold mb-4">Enquiry form</h1>
  <form class="space-y-4" method="POST" name="contact-form" id="contact-form">
    <input
      type="text"
      placeholder="Your Name"
      name="Name"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      required
    />
    <input
      type="email"
      placeholder="Your Email"
      name="Email"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      required
    />
    <input
      type="text"
      placeholder="Your Phone"
      name="Phone no."
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
      required
    />
    <input
      type="text"
      placeholder="Your Subject"
      name="Subject"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
    <textarea
      placeholder="Your Message"
      name="Description"
      class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
    ></textarea>
    <button type="submit" class="w-full p-3 rounded">
      Send Message
    </button>
  </form>
</div>

<script>
  const form = document.forms['contact-form'];
  const scriptURL = import.meta.env.PUBLIC_GOOGLE_SCRIPT_URL;

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Get form values
    const name = form['Name'].value.trim();
    const email = form['Email'].value.trim();
    const phone = form['Phone no.'].value.trim();

    // Basic validation
    if (!name) {
      alert('Name field cannot be empty.');
      return;
    }

    if (!email) {
      alert('Email field cannot be empty.');
      return;
    }

    if (!phone || phone.length <= 10) {
      alert('Phone number must be greater than 10 digits.');
      return;
    }

    try {
      const response = await fetch(scriptURL, {
        method: 'POST',
        mode: 'no-cors',
        body: new FormData(form),
      });
      alert('Thank you! Your form is submitted successfully.');
      console.log(response);
      window.location.reload();
    } catch (e) {
      console.log('error', e);
    }
  });
</script>
